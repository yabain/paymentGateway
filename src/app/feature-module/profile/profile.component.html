<!-- Page Wrapper -->
<div class="content container-fluid">
  <div class="row justify-content-lg-center">
    <div class="col-lg-12">

      <div class="profile-cover">
        <div class="profile-cover-wrap">
          <img class="profile-cover-img" src="{{cover}}" alt="">
        </div>
      </div>

      <div class="text-center mb-5">
        <form [formGroup]="uploadPictureForm" class="" style="text-align: center;"
          *ngIf="currentUser && uploadPictureForm">
          <div class="avatar avatar-xxl profile-cover-avatar">
            <img class="avatar-img" src="{{userData?.pictureUrl ? userData?.pictureUrl  : 'assets/img/new/user.png'}}"
              alt="">
            <span class="avatar-edit" (click)="changePicture(true);fileUploader.click()">
              <i class="feather icon-camera avatar-uploader-icon shadow-soft"></i>
            </span>
            <input type="file" name="picture" id="picture" accept="image/*" class="form-control ml-4" #fileUploader
              formControlName="pictureFile" (change)="showPreview($event)" style="display: none;">
          </div>
        </form>
        <div class="div">
          <span class="badge m-1 rounded-pill badge-outline-success"
            *ngIf="currentUser && !currentUser?.premium && currentUser?.verified && !currentUser?.warning">
            <i class="feather icon-check-circle"></i> {{ "badge.verified" | translate }}</span>
          <span class="badge m-1 rounded-pill badge-outline-warning" *ngIf="currentUser && currentUser?.warning">
            <i class="feather icon-alert-triangle"></i> {{ 'profile.warningAccount' | translate }}</span>
          <span class="badge m-1 badge-gradient-success"
            *ngIf="currentUser && currentUser?.premium && !currentUser?.warning">
            <i class="feather icon-zap"></i> Premium</span>
          <span class="badge m-1 badge-soft-warning badge-border"
            *ngIf="currentUser && !currentUser?.verified && !currentUser?.warning">
            <i class="feather icon-disc"></i> {{ "badge.notVerified" | translate }}</span>
          <span class="badge m-1 badge-soft-danger badge-border"
            *ngIf="currentUser && !currentUser?.verified && currentUser?.isActive === false">
            <i class="feather icon-user-x"></i> {{ "badge.inactive" | translate }}</span>
          <span class="badge m-1 badge-soft-dark badge-border" *ngIf="currentUser && currentUser?.inVerification">
            <i class="feather icon-refresh-ccw"></i> {{ "badge.inVerification" | translate }}</span>
          <span class="badge m-1 badge-gradient-primary" *ngIf="currentUser && currentUser?.isAdmin">
            <i class="feather icon-slack"></i> Admin</span>
          <div name="checkmark-done-outline" class="verified-badge"
            *ngIf="currentUser && currentUser?.verified && !currentUser?.vip && !currentUser?.warning && !currentUser?.premium ">
          </div>
          <p *ngIf="currentUser && currentUser?.warning" class="warning-message">{{ 'profile.warningAccount' |
            translate }}</p>
        </div>
        <br>
        <div *ngIf="isChangePicture">
          <a class="btn btn-sm btn-secondary m-2" (click)="cancel()">{{ "action.cancel" |
            translate }}</a>
          <a *ngIf="!uploadingPicture" class="btn btn-sm btn-success m-2" (click)="savePicture()">{{ "action.save" |
            translate }}</a>
          <a *ngIf="uploadingPicture" class="btn btn-sm btn-success" disabled>
            <img src="assets/img/new/loader.gif" width="20px">
          </a>
        </div>
        <h2>
          {{ showName(userData) }}
          <!-- <i class="fas fa-certificate text-primary small" data-bs-toggle="tooltip" data-placement="top" title="" data-original-title="Verified"></i> -->
        </h2>
        <ul class="list-inline" *ngIf="userData">
          <li class="list-inline-item" *ngIf="userData?._id">
            ID: <span style="margin-left: 5px;">{{userData?._id ?
              userData?._id : ''}}</span>
          </li>
        </ul>
        <div *ngIf="!userData">
          <img src="assets/img/new/loader.gif" width="20px">
        </div>
      </div>

      <!-- account reported as dangerous -->
      <div class="alert alert-warning alert-dismissible fade show" role="alert"
        *ngIf="currentUser && currentUser?.warning">
        <strong>{{ "badge.warning" | translate }}: </strong>
        {{ "alert.warningAccount" | translate }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>

      <!-- Verify your account -->
      <div class="alert alert-warning alert-dismissible fade show" role="alert"
        *ngIf="currentUser && !currentUser?.verified">
        <strong>{{ "badge.unVerified" | translate }}: </strong>
        {{ "alert.needToVerifyAccount" | translate }} <br>
        <button class="btn btn-info">{{ "profile.startVerification" | translate }}</button>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>

      <!-- Account in verification -->
      <div class="alert alert-secondary alert-dismissible fade show" role="alert"
        *ngIf="currentUser && currentUser?.inVerification">
        <strong>{{ "badge.inVerification" | translate }}: </strong>
        {{ "alert.inVerification" | translate }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>

      <!-- Account disabled -->
      <div class="alert alert-danger alert-dismissible fade show" role="alert"
        *ngIf="currentUser && currentUser?.isActive === false">
        <strong>{{ "badge.inactive" | translate }}: </strong>
        {{ "alert.inactiveAccount" | translate }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>

      <div class="row">
        <div class="col-lg-4">
          <div class="card">
            <div class="card-header">
              <h5 class="card-title d-flex justify-content-between">
                <span>{{ "sideMenu.profile" | translate }}</span>
                <a class="btn btn-sm btn-white" (click)="edit()" *ngIf="!edition && !loading">
                  <i class="feather icon-edit"></i>
                  {{ "action.edit" | translate }}</a>
                <a class="btn btn-sm btn-secondary" (click)="edit()" *ngIf="edition && !loading">{{ "action.cancel" |
                  translate }}</a>
                <a class="btn btn-sm btn-success" (click)="submit()" *ngIf="edition && !loading">{{ "action.save" |
                  translate }}</a>
                <span class="spinner-border spinner-border-sm me-2" role="status" *ngIf="loading"></span>
              </h5>
              <div *ngIf="currentUser && currentUser?.verified && edition">
                <br>
                <div class="alert alert-secondary alert-dismissible fade show" role="alert">
                  {{ "alert.verifiedAccount" | translate }}
                </div>
              </div>
            </div>
            <div class="card-body" *ngIf="!userData" style="text-align: center;">
              <img src="assets/img/new/loader.gif" width="20px">
            </div>
            <div class="card-body" *ngIf="userData">
              <form [formGroup]="form" (ngSubmit)="submit()">
                <ul class="list-unstyled">
                  <li class="py-0" *ngIf="userData?.accountType === 'organisation'">
                    <i class="feather icon-user" style="margin-right: 5px;"></i>
                    <small class="text-dark">{{ "profile.name" | translate }} *</small>
                    <input type="text" formControlName="name" class="form-control"
                      [class.is-invalid]="form.get('name')?.invalid && form.get('name')?.touched">
                    <div class="invalid-feedback" *ngIf="form.get('name')?.invalid && form.get('name')?.touched">
                      {{ "auth.requiredField" | translate }}
                    </div>
                  </li>

                  <li class="py-0" *ngIf="userData?.accountType === 'personal'">
                    <i class="feather icon-user" style="margin-right: 5px;"></i>
                    <small class="text-dark">{{ "auth.firstName" | translate }} *</small>
                    <input type="text" formControlName="firstName" class="form-control"
                      [class.is-invalid]="form.get('firstName')?.invalid && form.get('firstName')?.touched">
                    <div class="invalid-feedback"
                      *ngIf="form.get('firstName')?.invalid && form.get('firstName')?.touched">
                      {{ "auth.requiredField" | translate }}
                    </div>
                  </li>

                  <li class="mt-3 py-0" *ngIf="userData?.accountType === 'personal'">
                    <i class="feather icon-user" style="margin-right: 5px;"></i>
                    <small class="text-dark">{{ "auth.lastName" | translate }} *</small>
                    <input type="text" formControlName="lastName" class="form-control"
                      [class.is-invalid]="form.get('lastName')?.invalid && form.get('lastName')?.touched">
                    <div class="invalid-feedback"
                      *ngIf="form.get('lastName')?.invalid && form.get('lastName')?.touched">
                      {{ "auth.requiredField" | translate }}
                    </div>
                  </li>

                  <li class="mt-3 pb-0">
                    <i class="feather icon-user" style="margin-right: 5px;"></i>
                    <small class="text-dark">{{ "profile.gender" | translate }}</small>
                    <select class="select form-select form-control" formControlName="gender"
                      [class.is-invalid]="form.get('gender')?.invalid && form.get('gender')?.touched">
                      <option value="male" selected>{{ "profile.male" | translate }}</option>
                      <option value="female">{{ "profile.femal" | translate }}</option>
                    </select>
                    <div class="invalid-feedback" *ngIf="form.get('gender')?.invalid && form.get('gender')?.touched">
                      {{ "auth.requiredField" | translate }}
                    </div>
                  </li>

                  <li class="mt-3 pb-0">
                    <i class="feather icon-map-pin" style="margin-right: 5px;"></i>
                    <small class="text-dark">{{ "auth.country" | translate }}</small>
                    <input type="text" class="form-control" value="{{userData?.countryId.name}}" disabled>
                  </li>

                  <li class="mt-3 pb-0">
                    <i class="feather icon-map-pin" style="margin-right: 5px;"></i><small class="text-dark">
                      {{ "auth.city" | translate }}</small>
                    <select id="city" formControlName="cityId" class="form-select"
                      [class.is-invalid]="form.get('cityId')?.invalid && form.get('cityId')?.touched">
                      <option *ngFor="let city of allCities" value="{{city._id}}">
                        {{city.name}}
                      </option>
                    </select>
                    <div class="invalid-feedback" *ngIf="form.get('cityId')?.invalid && form.get('cityId')?.touched">
                      {{ "auth.requiredField" | translate }}
                    </div>
                  </li>

                  <li class="mt-3 pb-0">
                    <i class="feather icon-map-pin" style="margin-right: 5px;"></i>
                    <small class="text-dark">{{ "mail.address" | translate }}</small>
                    <input type="text" formControlName="address" *ngIf="userData?.phone" class="form-control"
                      [class.is-invalid]="form.get('address')?.invalid && form.get('address')?.touched">
                    <div class="invalid-feedback" *ngIf="form.get('address')?.invalid && form.get('address')?.touched">
                      {{ "auth.requiredField" | translate }}
                    </div>
                  </li>

                  <li class="mt-3 pb-0">
                    <i class="feather icon-phone" style="margin-right: 5px;"></i>
                    <small class="text-dark">{{ "terms.phone" | translate }}</small>
                    <input type="text" formControlName="phone" class="form-control"
                      [class.is-invalid]="form.get('phone')?.invalid && form.get('phone')?.touched">
                    <div class="invalid-feedback" *ngIf="form.get('phone')?.invalid && form.get('phone')?.touched">
                      {{ "auth.requiredField" | translate }}
                    </div>
                  </li>

                  <li class="mt-3 pb-0">
                    <i class="feather icon-mail" style="margin-right: 5px;"></i>
                    <small class="text-dark">{{ "terms.email" | translate }}</small>
                    <small class="text-dark" *ngIf="edition"><br>
                      <button class="btn btn-light">
                        <i class="feather icon-edit"></i> {{ "profile.changeEmail" | translate }}
                      </button>
                    </small>
                    <input type="text" class="form-control" value="{{userData?.email}}" disabled>
                  </li>

                  <li class="mt-3 pb-0">
                    <i class="feather icon-mail" style="margin-right: 5px;"></i>
                    <small class="text-dark">{{ "auth.password" | translate }}</small>
                    <small class="text-dark" *ngIf="edition"><br>
                      <button class="btn btn-light">
                        <i class="feather icon-edit"></i> {{ "profile.changePassword" | translate }}
                      </button>
                    </small>
                    <input type="text" class="form-control" value="*********" disabled>
                  </li>

                  <li class="mt-3 pb-0">
                    <img src="assets/img/ressorces/WhatsApp.svg.webp" alt="" style="width: 15px; margin-right: 5px;">
                    <small class="text-dark">Whatsapp</small>
                    <small class="text-dark" *ngIf="edition"><br>
                      <button class="btn btn-light">
                        <i class="feather icon-edit"></i> {{ "profile.changeWhatsapp" | translate }}
                      </button>
                    </small>
                    <input type="text" value="+{{userData?.whatsapp}}" class="form-control" disabled>
                  </li>

                  <li class="mt-3 pb-0">
                    <i class="feather icon-user" style="margin-right: 5px;"></i>
                    <small class="text-dark">{{ "lang.title" | translate }}</small>
                    <select class="select form-select form-control" formControlName="language">
                      <img src="assets/icons/fr-flag.svg" alt="" style="width: 15px; height: 12px;">
                      <option value="fr" selected>{{ "lang.fr" | translate }}</option>
                      <option value="en">{{ "lang.en" | translate }}</option>
                    </select>
                  </li>

                  <li class="mt-3 pb-0">
                    <i class="feather icon-calendar" style="margin-right: 5px;"></i><small class="text-dark">{{
                      "users.creationDate" |
                      translate }}</small>
                    <input type="text" class="form-control" value="{{userData?.createdAt | date: 'dd/MM/YYYY'}}"
                      disabled>
                  </li>
                </ul>
              </form>
            </div>
          </div>
        </div>
        <div class="col-lg-8">
          <div class="card">
            <div class="card-header d-flex justify-content-between">
              <h5 class="card-title">{{ "profile.description" | translate }}</h5>
              <a class="btn btn-sm btn-white" (click)="editDescription()" *ngIf="!descriptionEdition && !loading2">
                <i class="feather icon-edit"></i>
                {{ "action.edit" | translate }}</a>
              <a class="btn btn-sm btn-white" (click)="editDescription()" *ngIf="descriptionEdition && !loading2">
                <i class="feather icon-edit"></i>
                {{ "action.cancel" | translate }}</a>
              <a class="btn btn-sm btn-success" (click)="saveDescription()" *ngIf="descriptionEdition && !loading2">
                <i class="feather icon-edit"></i>
                {{ "action.save" | translate }}</a>
                <span class="spinner-border spinner-border-sm me-2" role="status" *ngIf="loading2"></span>
            </div>
            <div class="card-body card-body-height" *ngIf="userData">
              <p *ngIf="currentUser && !descriptionEdition">{{ description }} </p>
              <textarea class="form-control" rows="8" *ngIf="currentUser && descriptionEdition" name="" id=""
                [(ngModel)]="description"></textarea>
            </div>
            <div class="card-body" *ngIf="!userData" style="text-align: center;">
            <span class="spinner-border spinner-border-sm me-2" role="status"></span>
            </div>
          </div>
          <div class="card">
            <div class="card-header">
              <h5 class="card-title">{{ "profile.activity" | translate }}</h5>
            </div>
            <div class="card-body card-body-height" *ngIf="userData">
              <ul class="activity-feed">
                <li class="feed-item">
                  <div class="feed-date">{{ formatDate() }} - {{ currentUser.createdAt | date: 'hh:mm' }}</div>
                  <span class="feed-text"><a>Action: </a>{{ "users.accountCreation" | translate }}</span>
                </li>
              </ul>
            </div>
            <div class="card-body" *ngIf="!userData" style="text-align: center;">
              <img src="assets/img/new/loader.gif" width="20px">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- /Page Wrapper -->